# é¡¹ç›®å®Œæˆæ€»ç»“

## ä¸€ã€é¡¹ç›®ç»“æ„

```
paddle_movie_recommender/
â”œâ”€â”€ data/                          # æ•°æ®æ¨¡å—
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ download_and_process.py    # æ•°æ®ä¸‹è½½å’Œé¢„å¤„ç†
â”‚   â”œâ”€â”€ dataset.py                 # æ•°æ®é›†å®šä¹‰
â”‚   â””â”€â”€ sequence_dataset.py        # SASRecåºåˆ—æ•°æ®å¤„ç†
â”œâ”€â”€ models/                        # æ¨¡å‹æ¨¡å—
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ ncf_model.py               # NCFæ¨¡å‹ï¼ˆGMF + MLP + ç‰¹å¾èåˆï¼‰
â”‚   â”œâ”€â”€ sasrec_model.py            # SASRecåºåˆ—æ¨èæ¨¡å‹
â”‚   â””â”€â”€ poster_feature.py          # æµ·æŠ¥ç‰¹å¾æå–ï¼ˆResNet50ï¼‰
â”œâ”€â”€ evaluation/                    # è¯„ä¼°æ¨¡å—
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ evaluator.py               # è¯„ä¼°æŒ‡æ ‡ï¼ˆMAE, RMSE, NDCGç­‰ï¼‰
â”œâ”€â”€ scripts/                       # è„šæœ¬
â”‚   â””â”€â”€ test_sasrec.py             # SASRecæµ‹è¯•è„šæœ¬
â”œâ”€â”€ recommender.py                 # æ¨èç³»ç»Ÿä¸»ç¨‹åº
â”œâ”€â”€ train.py                       # NCFè®­ç»ƒè„šæœ¬
â”œâ”€â”€ train_sasrec.py                # SASRecè®­ç»ƒè„šæœ¬
â”œâ”€â”€ main.py                        # å…¥å£è„šæœ¬
â”œâ”€â”€ README.md                      # é¡¹ç›®è¯´æ˜æ–‡æ¡£
â”œâ”€â”€ requirements.txt               # ä¾èµ–åˆ—è¡¨
â””â”€â”€ docs/
    â””â”€â”€ main.ipynb                 # ä¸»æ–‡æ¡£ï¼ˆJupyter Notebookï¼‰
```

## äºŒã€åŠŸèƒ½å®ç°æƒ…å†µ

### âœ… å·²å®ç°çš„åŠŸèƒ½

| åŠŸèƒ½ | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|
| **çƒ­é—¨æ¨è** | âœ… å®ç° | åŸºäºè¯„åˆ†é¢‘ç‡é€‰æ‹©çƒ­é—¨ç”µå½± |
| **æ–°å“æ¨è** | âœ… å®ç° | åŸºäºé¦–æ˜ æ—¶é—´æ¨èæ–°ç”µå½± |
| **ä¸ªæ€§åŒ–æ¨è** | âœ… å®ç° | åŸºäºNCFæ¨¡å‹è¿›è¡Œä¸ªæ€§åŒ–æ¨è |
| **SASRecåºåˆ—æ¨è** | âœ… å®ç° | åŸºäºTransformerçš„åºåˆ—æ¨è |
| **æ··åˆæ¨è** | âœ… å®ç° | æŒ‰2:3:5æ¯”ä¾‹æ··åˆä¸‰ç§æ¨è |
| **ç›¸ä¼¼ç”¨æˆ·æ¨è** | âœ… å®ç° | åŸºäºç”¨æˆ·ç‰¹å¾çš„ä½™å¼¦ç›¸ä¼¼åº¦ |
| **ç›¸ä¼¼ç”µå½±æ¨è** | âœ… å®ç° | åŸºäºå†…å®¹å’Œæµ·æŠ¥çš„ç›¸ä¼¼åº¦ |
| **æ–°ç”¨æˆ·å†·å¯åŠ¨** | âœ… å®ç° | çƒ­é—¨+æ–°å“æ··åˆæ¨è |
| **æµ·æŠ¥ç‰¹å¾æå–** | âœ… å®ç° | ä½¿ç”¨ResNet50æå–è§†è§‰ç‰¹å¾ |
| **MAE/RMSE** | âœ… å®ç° | å›å½’è¯„ä¼°æŒ‡æ ‡ |
| **Accuracy** | âœ… å®ç° | åˆ†ç±»å‡†ç¡®ç‡ |
| **Precision/Recall/F1** | âœ… å®ç° | åˆ†ç±»è¯„ä¼°æŒ‡æ ‡ |
| **NDCG/HitRate** | âœ… å®ç° | æ’åºè¯„ä¼°æŒ‡æ ‡ |
| **æ··æ·†çŸ©é˜µ** | âœ… å®ç° | 5x5æ··æ·†çŸ©é˜µ |
| **è¦†ç›–ç‡** | âœ… å®ç° | æ¨èè¦†ç›–ç‡è®¡ç®— |
| **å¤šæ ·æ€§** | âœ… å®ç° | å¤šæ ·æ€§è®¡ç®— |

### ğŸ“Š æ•°æ®é›†å¢å¼º

| å¢å¼ºé¡¹ | çŠ¶æ€ | è¯´æ˜ |
|--------|------|------|
| é¦–æ˜ å¹´ä»½æå– | âœ… å®ç° | ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼ä»æ ‡é¢˜ä¸­æå– |
| é‚®ç¼–ä½¿ç”¨ | âœ… å®ç° | ä¿ç•™å¹¶ä½œä¸ºç”¨æˆ·åœ°ç†ä½ç½®ç‰¹å¾ |
| æµ·æŠ¥æ•°æ® | âš ï¸ éƒ¨åˆ† | ä»MovieLens Poster Datasetä¸‹è½½ |

## ä¸‰ã€ä½¿ç”¨æ–¹æ³•

### 1. ç¯å¢ƒé…ç½®

```bash
cd /var/home/yimo/Repos/PaddleRec/projects/paddle_movie_recommender
source .venv/bin/activate
pip install -r requirements.txt
```

### 2. æ•°æ®å‡†å¤‡

```bash
python main.py
```

è¿™å°†è‡ªåŠ¨ï¼š
- ä¸‹è½½ml-1mæ•°æ®é›†
- ä¸‹è½½ç”µå½±æµ·æŠ¥æ•°æ®ï¼ˆçº¦40%è¦†ç›–ç‡ï¼‰
- å¤„ç†æ•°æ®å¹¶æå–ç‰¹å¾
- è®¡ç®—ç›¸ä¼¼åº¦çŸ©é˜µ

### 3. æ¨¡å‹è®­ç»ƒ

```bash
# NCFæ¨¡å‹è®­ç»ƒ
python train.py --epochs 10 --batch_size 256

# SASRecåºåˆ—æ¨èè®­ç»ƒ
python train_sasrec.py --epochs 20 --batch_size 64 --max_len 50
```

### 4. æµ‹è¯•æ¨è

```bash
python recommender.py
```

### 5. SASRecæ¨¡å‹æµ‹è¯•

```bash
python models/sasrec_model.py
python data/sequence_dataset.py
```

## å››ã€æ ¸å¿ƒä»£ç è¯´æ˜

### NCFæ¨¡å‹ç»“æ„

```
NCF (Neural Collaborative Filtering)
â”œâ”€â”€ GMF (Generalized Matrix Factorization)
â”‚   â”œâ”€â”€ User Embedding (32ç»´)
â”‚   â””â”€â”€ Item Embedding (32ç»´)
â”‚
â”œâ”€â”€ MLP (Multi-Layer Perceptron)
â”‚   â”œâ”€â”€ User Embedding (32ç»´)
â”‚   â”œâ”€â”€ Item Embedding (32ç»´)
â”‚   â””â”€â”€ MLP Layers [64, 32, 16]
â”‚
â”œâ”€â”€ Feature Fusion
â”‚   â”œâ”€â”€ User Features (4ç»´)
â”‚   â”œâ”€â”€ Movie Features (20ç»´)
â”‚   â””â”€â”€ Poster Features (2048ç»´)
â”‚
â””â”€â”€ Output Layer [64, 32, 1]
```

### SASRecæ¨¡å‹ç»“æ„

```
SASRec (Self-Attentive Sequential Recommendation)
â”œâ”€â”€ Item Embedding (64ç»´, åŒ…å«padding 0)
â”œâ”€â”€ Position Embedding (64ç»´, æœ€å¤§é•¿åº¦50)
â”‚
â”œâ”€â”€ Transformer Encoder
â”‚   â”œâ”€â”€ Multi-Head Self-Attention (2 heads)
â”‚   â”œâ”€â”€ Feed-Forward Network
â”‚   â””â”€â”€ Layer Normalization
â”‚
â””â”€â”€ Output Layer
    â”œâ”€â”€ è®­ç»ƒæ¨¡å¼: æ­£è´Ÿæ ·æœ¬å¯¹æ¯”å­¦ä¹ 
    â””â”€â”€ æ¨ç†æ¨¡å¼: é¢„æµ‹ä¸‹ä¸€ä¸ªç‰©å“
```

### æ¨èè·¯å¾„æ¯”ä¾‹

```
æ¯æ¬¡æ¨èæ€»æ•°: 10æ¡
â”œâ”€â”€ çƒ­é—¨æ¨è: 2æ¡ (20%)
â”œâ”€â”€ æ–°å“æ¨è: 3æ¡ (30%)
â””â”€â”€ ä¸ªæ€§åŒ–æ¨è: 5æ¡ (50%)
```

## äº”ã€è¯„ä¼°æŒ‡æ ‡è¯´æ˜

| æŒ‡æ ‡ | èŒƒå›´ | è¯´æ˜ |
|------|------|------|
| MAE | [0, âˆ) | è¶Šå°è¶Šå¥½ |
| RMSE | [0, âˆ) | è¶Šå°è¶Šå¥½ |
| Accuracy | [0, 1] | è¶Šå¤§è¶Šå¥½ |
| Precision@10 | [0, 1] | è¶Šå¤§è¶Šå¥½ |
| Recall@10 | [0, 1] | è¶Šå¤§è¶Šå¥½ |
| NDCG@10 | [0, 1] | è¶Šå¤§è¶Šå¥½ |
| HitRate@10 | [0, 1] | è¶Šå¤§è¶Šå¥½ |
| Coverage | [0, 1] | è¶Šå¤§è¶Šå¥½ |
| Diversity | [0, 1] | è¶Šå¤§è¶Šå¥½ |

## å…­ã€é¢„æœŸæ€§èƒ½

æ ¹æ®æ¨¡å‹è®¾è®¡å’Œæ•°æ®é›†ç‰¹ç‚¹ï¼Œé¢„æœŸè¾¾åˆ°çš„æ€§èƒ½ï¼š

- **NCF MAE**: 0.70 - 0.80
- **NCF RMSE**: 0.90 - 1.00
- **NCF Accuracy**: 68% - 75%
- **SASRec Hit@10**: 0.05 - 0.10 (20 epochs)
- **SASRec NDCG@10**: 0.03 - 0.08 (20 epochs)

## ä¸ƒã€åŠ åˆ†é¡¹å®ç°æƒ…å†µ

| åŠ åˆ†é¡¹ | çŠ¶æ€ | è¯´æ˜ |
|--------|------|------|
| æ•°æ®é›†æ‰©å…… | âœ… å®ç° | æå–äº†é¦–æ˜ å¹´ä»½ï¼Œä½¿ç”¨äº†é‚®ç¼– |
| æµ·æŠ¥æ•°æ® | âš ï¸ éƒ¨åˆ† | çº¦40%è¦†ç›–ç‡ |
| å¤šæ¨¡æ€ç‰¹å¾ | âœ… å®ç° | æµ·æŠ¥è§†è§‰ç‰¹å¾èåˆ |
| SASRecåºåˆ—æ¨è | âœ… å®ç° | Transformer-basedåºåˆ—æ¨è |
| æœ¬åœ°ç‰ˆæœ¬ | âœ… å®ç° | å®Œå…¨æœ¬åœ°è¿è¡Œ |

## å…«ã€æ³¨æ„äº‹é¡¹

1. **æµ·æŠ¥æ•°æ®**ï¼šMovieLens 1Mä¸åŒ…å«æµ·æŠ¥æ•°æ®ï¼Œéœ€è¦é¢å¤–ä¸‹è½½MovieLens Poster Dataset
2. **GPUæ”¯æŒ**ï¼šæµ·æŠ¥ç‰¹å¾æå–æ¨èä½¿ç”¨GPUåŠ é€Ÿ
3. **é¦–æ¬¡è¿è¡Œ**ï¼šéœ€è¦ä¸‹è½½çº¦200MBçš„æ•°æ®ï¼Œè¯·è€å¿ƒç­‰å¾…
4. **Pythonç‰ˆæœ¬**ï¼šæ¨èä½¿ç”¨Python 3.9ï¼Œ3.14+å¯èƒ½ä¸å…¼å®¹PaddlePaddle
5. **SASRecè®­ç»ƒ**ï¼šå»ºè®®20+ epochsä»¥è·å¾—æ›´å¥½çš„æ€§èƒ½

## ä¹ã€å‚è€ƒæ–‡æ¡£

- MovieLens 1M: https://grouplens.org/datasets/movielens/1m/
- PaddlePaddle: https://www.paddlepaddle.org.cn/
- NCFè®ºæ–‡: He, X., et al. (2017). Neural collaborative filtering. WWW.
- SASRecè®ºæ–‡: Kang, W., et al. (2018). Self-attentive sequential recommendation. ICDM.
